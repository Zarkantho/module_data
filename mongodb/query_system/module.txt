###### query_system ######


# Matcher expressions. The point of all of this is to take a query string and turn it into a
# structured set of classes. If this were a compiler this would be the parse tree for the compiler.

src/mongo/db/matcher/expression.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/expression.h
src/mongo/db/matcher/expression_array.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/expression_array.h
src/mongo/db/matcher/expression_array_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_geo.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/expression_geo.h
src/mongo/db/matcher/expression_geo_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_leaf.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/expression_leaf.h
src/mongo/db/matcher/expression_leaf_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_parser.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/expression_parser.h
src/mongo/db/matcher/expression_parser_array_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_parser_geo.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/expression_parser_geo_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_parser_leaf_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_parser_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_parser_text.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/expression_parser_text_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_parser_tree.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/expression_parser_tree_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_text.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/expression_text.h
src/mongo/db/matcher/expression_tree.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/expression_tree.h
src/mongo/db/matcher/expression_tree_test.cpp (not built in anywhere)
src/mongo/db/matcher/expression_where.cpp (mongod, mongos, and tools)

# This is the code to say "does this document match the expression"? This is built on the
# expressions above.

# Helper classes for managing document matching. Related to the expressions above.

src/mongo/db/matcher/matchable.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/matchable.h
src/mongo/db/matcher/path.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/path.h
src/mongo/db/matcher/path_internal.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/path_internal.h
src/mongo/db/matcher/path_test.cpp (not built in anywhere)

# Interface to actually test if a document matches.

src/mongo/db/matcher/matcher.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/matcher.h
src/mongo/db/matcher.h

# Helper for requesting more details about what matched our query from the matcher system.

src/mongo/db/matcher/match_details.cpp (mongod, mongos, and tools)
src/mongo/db/matcher/match_details.h

# Planning/parsing/optimization for new query framework
## not execution as well? (what are all these *runner.cpp files?)

src/mongo/db/query/cached_plan_runner.cpp (mongod and tools)
src/mongo/db/query/cached_plan_runner.h
src/mongo/db/query/canonical_query.cpp (mongod, mongos, and tools)
src/mongo/db/query/canonical_query.h
src/mongo/db/query/canonical_query_test.cpp
src/mongo/db/query/eof_runner.cpp (mongod and tools)
src/mongo/db/query/eof_runner.h
src/mongo/db/query/explain_plan.cpp (mongod and tools)
src/mongo/db/query/explain_plan.h
src/mongo/db/query/find_constants.h
src/mongo/db/query/get_runner.cpp (mongod and tools)
src/mongo/db/query/get_runner.h
src/mongo/db/query/get_runner_test.cpp
src/mongo/db/query/idhack_runner.cpp (mongod and tools)
src/mongo/db/query/idhack_runner.h
src/mongo/db/query/index_bounds.cpp (mongod, mongos, and tools)
src/mongo/db/query/index_bounds.h
src/mongo/db/query/index_bounds_builder.cpp (mongod, mongos, and tools)
src/mongo/db/query/index_bounds_builder.h
src/mongo/db/query/index_bounds_builder_test.cpp (not built in anywhere)
src/mongo/db/query/index_bounds_test.cpp (not built in anywhere)
src/mongo/db/query/index_entry.h
src/mongo/db/query/index_tag.cpp (mongod, mongos, and tools)
src/mongo/db/query/index_tag.h
src/mongo/db/query/indexability.h
src/mongo/db/query/internal_plans.h
src/mongo/db/query/internal_runner.cpp (mongod and tools)
src/mongo/db/query/internal_runner.h
src/mongo/db/query/interval.cpp (mongod, mongos, and tools)
src/mongo/db/query/interval.h
src/mongo/db/query/interval_test.cpp (not built in anywhere)
src/mongo/db/query/lite_parsed_query.cpp (mongod, mongos, and tools)
src/mongo/db/query/lite_parsed_query.h
src/mongo/db/query/lite_parsed_query_test.cpp (not built in anywhere)
src/mongo/db/query/multi_plan_runner.cpp (mongod and tools)
src/mongo/db/query/multi_plan_runner.h
src/mongo/db/query/new_find.cpp (mongod and tools)
src/mongo/db/query/new_find.h
src/mongo/db/query/parsed_projection.cpp (mongod, mongos, and tools)
src/mongo/db/query/parsed_projection.h
src/mongo/db/query/parsed_projection_test.cpp (not built in anywhere)
src/mongo/db/query/plan_cache.cpp (mongod, mongos, and tools)
src/mongo/db/query/plan_cache.h
src/mongo/db/query/plan_cache_test.cpp (not built in anywhere)
src/mongo/db/query/plan_enumerator.cpp (mongod, mongos, and tools)
src/mongo/db/query/plan_enumerator.h
src/mongo/db/query/plan_executor.cpp (mongod and tools)
src/mongo/db/query/plan_executor.h
src/mongo/db/query/plan_ranker.cpp (mongod and tools)
src/mongo/db/query/plan_ranker.h
src/mongo/db/query/planner_access.cpp (mongod, mongos, and tools)
src/mongo/db/query/planner_access.h
src/mongo/db/query/planner_analysis.cpp (mongod, mongos, and tools)
src/mongo/db/query/planner_analysis.h
src/mongo/db/query/planner_ixselect.cpp (mongod, mongos, and tools)
src/mongo/db/query/planner_ixselect.h
src/mongo/db/query/planner_ixselect_test.cpp (not built in anywhere)
src/mongo/db/query/qlog.cpp (mongod, mongos, and tools)
src/mongo/db/query/qlog.h
src/mongo/db/query/query_planner.cpp (mongod, mongos, and tools)
src/mongo/db/query/query_planner.h
src/mongo/db/query/query_planner_common.h
src/mongo/db/query/query_planner_params.h
src/mongo/db/query/query_planner_test.cpp (not built in anywhere)
src/mongo/db/query/query_planner_test_lib.cpp
src/mongo/db/query/query_planner_test_lib.h
src/mongo/db/query/query_settings.cpp
src/mongo/db/query/query_settings.h
src/mongo/db/query/query_solution.cpp (mongod, mongos, and tools)
src/mongo/db/query/query_solution.h
src/mongo/db/query/runner.h
src/mongo/db/query/runner_yield_policy.h
src/mongo/db/query/single_solution_runner.cpp (mongod and tools)
src/mongo/db/query/single_solution_runner.h
src/mongo/db/query/stage_builder.cpp (mongod and tools)
src/mongo/db/query/stage_builder.h
src/mongo/db/query/stage_types.h
src/mongo/db/query/type_explain.cpp (mongod and tools)
src/mongo/db/query/type_explain.h

# Executor for new query framework
## oh. what is the relationship between 'runners' and e.g. 'index_scan'
## here?
src/mongo/db/exec/2d.cpp (mongod and tools)
src/mongo/db/exec/2d.h
src/mongo/db/exec/2dcommon.cpp (mongod and tools)
src/mongo/db/exec/2dcommon.h
src/mongo/db/exec/2dnear.cpp (mongod and tools)
src/mongo/db/exec/2dnear.h
src/mongo/db/exec/and_common-inl.h
src/mongo/db/exec/and_hash.cpp (mongod and tools)
src/mongo/db/exec/and_hash.h
src/mongo/db/exec/and_sorted.cpp (mongod and tools)
src/mongo/db/exec/and_sorted.h
src/mongo/db/exec/collection_scan.cpp (mongod and tools)
src/mongo/db/exec/collection_scan.h
src/mongo/db/exec/collection_scan_common.h
src/mongo/db/exec/fetch.cpp (mongod and tools)
src/mongo/db/exec/fetch.h
src/mongo/db/exec/filter.h
src/mongo/db/exec/index_scan.cpp (mongod and tools)
src/mongo/db/exec/index_scan.h
src/mongo/db/exec/limit.cpp (mongod and tools)
src/mongo/db/exec/limit.h
src/mongo/db/exec/merge_sort.cpp (mongod and tools)
src/mongo/db/exec/merge_sort.h
src/mongo/db/exec/mock_stage.cpp (not built in anywhere)
src/mongo/db/exec/mock_stage.h
src/mongo/db/exec/oplogstart.cpp (mongod and tools)
src/mongo/db/exec/oplogstart.h
src/mongo/db/exec/or.cpp (mongod and tools)
src/mongo/db/exec/or.h
src/mongo/db/exec/plan_stage.h
src/mongo/db/exec/plan_stats.h
src/mongo/db/exec/projection.cpp (mongod and tools)
src/mongo/db/exec/projection.h
src/mongo/db/exec/projection_exec.cpp (mongod and tools)
src/mongo/db/exec/projection_exec.h
src/mongo/db/exec/projection_exec_test.cpp (not built in anywhere)
src/mongo/db/exec/s2near.cpp (mongod and tools)
src/mongo/db/exec/s2near.h
src/mongo/db/exec/shard_filter.cpp (mongod and tools)
src/mongo/db/exec/shard_filter.h
src/mongo/db/exec/skip.cpp (mongod and tools)
src/mongo/db/exec/skip.h
src/mongo/db/exec/sort.cpp (mongod and tools)
src/mongo/db/exec/sort.h
src/mongo/db/exec/sort_test.cpp (not built in anywhere)
src/mongo/db/exec/stagedebug_cmd.cpp (mongod and tools)
src/mongo/db/exec/text.cpp (mongod and tools)
src/mongo/db/exec/text.h
src/mongo/db/exec/working_set.cpp (mongod, mongos, and tools)
src/mongo/db/exec/working_set.h
src/mongo/db/exec/working_set_common.cpp (mongod and tools)
src/mongo/db/exec/working_set_common.h
src/mongo/db/exec/working_set_computed_data.h
src/mongo/db/exec/working_set_test.cpp (not built in anywhere)

# Legacy utilities for managing queries. Has utilities like range intersection and application of
# skip and limit. These are allllmost dead. The functionality should be replaced by the new
# matcher, expressions, and query system.

src/mongo/db/queryutil-inl.h
src/mongo/db/queryutil.cpp (mongod, mongos, and tools)
src/mongo/db/queryutil.h

# Old way of doing document projections. Given a doc and a projection, transforms the document.
## what calls it, and where are projections done now?
src/mongo/db/projection.cpp (mongod, mongos, and tools)
src/mongo/db/projection.h

# Entry point for various database operations
## locks: we should clarify locking, e.g. everything in update.cpp happens
## in the context of a db write lock
## should clarify the relationship between these and db/instance.cpp (not built in anywhere)
src/mongo/db/ops/count.cpp (mongod and tools)
src/mongo/db/ops/count.h
src/mongo/db/ops/delete.cpp (mongod and tools)
src/mongo/db/ops/delete.h
src/mongo/db/ops/insert.cpp (mongod and tools)
src/mongo/db/ops/insert.h
src/mongo/db/ops/update.cpp (mongod and tools)
src/mongo/db/ops/update.h


